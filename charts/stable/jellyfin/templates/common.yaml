{{- include "tc.v1.common.loader.init" . }}

{{- if .Values.autodiscovery.enabled -}}
{{/* Add proxy workload */}}
{{- $_ := set .Values.workload.broadcastproxy "enabled" true -}}
{{- end -}}

{{- if .Values.ingress.main.cors.enabled -}}
{{- $newMiddlewares :=  list "tc-opencors-chain" }}
{{- $_ := set .Values.ingress.main "fixedMiddlewares" $newMiddlewares -}}
{{- end -}}

{{- include "tc.v1.common.loader.apply" . -}}
