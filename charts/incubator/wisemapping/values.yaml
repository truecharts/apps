image:
  repository: wisemapping/wisemapping
  pullPolicy: IfNotPresent
  tag: 5.0.14@sha256:7ceea1a5d49160f894c6b8efbfe350ba6b4460a9c0f2ccab221a38ce9dcfe90d

# When this is defined, the contents will be mounted
# as configmap into the container at /usr/local/tomcat/webapps/ROOT/WEB-INF/app.properties.
wisemappingConfig: {}

securityContext:
  container:
    readOnlyRootFilesystem: false
    runAsNonRoot: false
    runAsUser: 0
    runAsGroup: 0

service:
  main:
    ports:
      main:
        port: 8080
        targetPort: 8080

workload:
  main:
    podSpec:
      initContainers:
        init-config:
          enabled: "{{ not .Values.wisemappingConfig }}"
          type: init
          imageSelector: alpineImage
          command:
            - /bin/sh
            - -c
            - |
              mkdir -p /usr/local/tomcat/webapps/ROOT/WEB-INF/
              if [ ! -f /usr/local/tomcat/webapps/ROOT/WEB-INF/app.properties ]; then
                echo "Config file not found, copying dummy..."
                cp /usr/local/tomcat/webapps/ROOT/WEB-INF/app.properties.dummy /usr/local/tomcat/webapps/ROOT/WEB-INF/app.properties
                echo "Config file copied, you can now edit it at /usr/local/tomcat/webapps/ROOT/WEB-INF/app.properties"
              fi

persistence:
  config:
    # Only enable when not using wisemappingConfig
    enabled: false
    mountPath: /config
    subPath: app.properties
    targetSelector:
      main:
        main: {}
        init-config: {}

cnpg:
  main:
    enabled: true
    user: wisemapping
    database: wisemapping

portal:
  open:
    enabled: true

